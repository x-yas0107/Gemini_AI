# 🎹 CH32V006 DTMF Master

![Version](https://img.shields.io/badge/Version-1.00--Stable-brightgreen.svg)
![MCU](https://img.shields.io/badge/MCU-CH32V006F8P6-red.svg)
![License](https://img.shields.io/badge/License-MIT-blue.svg)

**CH32V006 DTMF Master** は、低コストなRISC-Vマイコン「CH32V006」を使用し、DTMF（電話回線のプッシュ音）のリアルタイム合成と、OLEDディスプレイへの波形描画を実現したプロジェクトです。

---

## 📖 プロジェクト概要

本プロジェクトは、**DDS（直接デジタル合成）方式**による正確な周波数生成と、128x32pxのSSD1306 OLEDへの**垂直線補完アルゴリズム**を用いたリアルタイム波形可視化を両立しています。物理的な画面幅の制約を考慮したレイアウト設計により、高い視認性と実用性を実現しました。

---

## 📍 物理ピン接続 (CH32V006F8P6 - SOP20)

実機配線時は、以下の物理ピン番号を厳守してください。

| 機能 | ポート | **物理ピン番号** | 接続先 | 備考 |
| :--- | :--- | :--- | :--- | :--- |
| **Audio Out** | **PD4** | **1番ピン** | スピーカー / アンプ | TIM2_CH1 PWM出力 |
| **UART TX** | **PD5** | **2番ピン** | USB-Serial RX | 115200bps ダッシュボード |
| **UART RX** | **PD6** | **3番ピン** | USB-Serial TX | 115200bps コマンド入力 |
| **GND** | **VSS** | **7番ピン** | 電源負極 | |
| **Power** | **VDD** | **9番ピン** | 電源正極 (3.3V) | |
| **I2C SDA** | **PC1** | **11番ピン** | OLED SDA | SSD1306 (128x32) |
| **I2C SCL** | **PC2** | **12番ピン** | OLED SCL | SSD1306 (128x32) |



---

## 🎮 操作方法 (Dashboard Manual)

シリアルターミナル（115200bps）から以下のキーで操作可能です。

- **[0-9, *, #]** : 単音再生 ＆ 入力バッファへ蓄積。
- **[ENTER]** : バッファ内の数値を一括で連続ダイヤル送出。
- **[p]** : メロディ（Secret Song）を自動演奏。
- **[+] / [-]** : 演奏速度（Tempo）を微調整。
- **[*]** : テンポを標準設定（80ms）にリセット。
- **[SPACE]** : 入力バッファをクリア。

---

## 🛠 技術的特長

### 1. DDS (Direct Digital Synthesis)
内部サインテーブルを位相アキュムレータでスキャンし、2つの周波数をリアルタイムでデジタル合成。PWMを通じて高精度なアナログ音声を生成します。

### 2. 垂直線補間描画アルゴリズム
ドット描画では途切れてしまう高周波波形に対し、前後のサンプリング点を垂直線で結ぶ補間処理を実装。OLED上で滑らかな波形表示を可能にしました。



### 3. UIレイアウトの物理最適化
128pxの表示限界における「文字の回り込みバグ」を回避するため、看板文字の描画座標を `X=2` と `X=61` に分割配置。左右にマージンを確保した安定したUIを提供します。

---

## 🤝 開発チーム

- **yas** : リード・アーキテクト、ハードウェア設計
- **Gemini (AI)** : アルゴリズム最適化、ドキュメント作成

---

## ⚖️ ライセンス

このプロジェクトは **MIT License** の下で公開されています。